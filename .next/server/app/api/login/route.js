(()=>{var e={};e.id=740,e.ids=[740],e.modules={62849:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=62849,e.exports=t},67096:e=>{"use strict";e.exports=require("bcrypt")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},98216:e=>{"use strict";e.exports=require("net")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},74026:e=>{"use strict";e.exports=require("string_decoder")},95346:e=>{"use strict";e.exports=require("timers")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},15673:e=>{"use strict";e.exports=require("node:events")},25463:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>h,requestAsyncStorage:()=>p,routeModule:()=>d,serverHooks:()=>f,staticGenerationAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{POST:()=>l});var a=r(73278),n=r(45002),i=r(54877),o=r(71309),u=r(1035),c=r(93159);async function l(e){try{let{username:t,password:r}=await e.json();if(!t||!r)return o.NextResponse.json({success:!1,message:"Kredensial tidak lengkap"},{status:400});let s=await (0,u.kY)(t);if(!s)return o.NextResponse.json({success:!1,message:"Kredensial tidak valid"},{status:401});if(s.password.length<20?s.password===r:await (0,c.G)(r,s.password))return o.NextResponse.json({success:!0,user:{id:s.id_user.toString(),name:s.username,email:`${s.username}@simbarku.com`}});return o.NextResponse.json({success:!1,message:"Kredensial tidak valid"},{status:401})}catch(e){return console.error("Login error:",e),o.NextResponse.json({success:!1,message:"Kesalahan server"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/login/route",pathname:"/api/login",filename:"route",bundlePath:"app/api/login/route"},resolvedPagePath:"D:\\Aplikasi\\simbarku\\app\\api\\login\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:p,staticGenerationAsyncStorage:m,serverHooks:f}=d,g="/api/login/route";function h(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:m})}},1035:(e,t,r)=>{"use strict";r.d(t,{AW:()=>T,B3:()=>R,FO:()=>E,IH:()=>A,Pz:()=>S,Rf:()=>O,Xp:()=>k,ZU:()=>M,_z:()=>U,kY:()=>P,qZ:()=>L});var s=r(87615),a=r(91141),n=r(56042),i=r(53283),o=r(57713),u=r(87420),c=r(31318),l=r(90273),d=r(41054),p=r(52792),m=r(18653),f=r(29785),g=r(9850),h=r(95013),y=r(98446),w=r(5183);let _=s.createPool({host:process.env.MYSQL_HOST||"localhost",port:Number(process.env.MYSQL_PORT)||3306,user:process.env.MYSQL_USER||"root",password:process.env.MYSQL_PASSWORD||"",database:process.env.MYSQL_DATABASE||"simbarku"}),N=(0,a.tS)(_),v=(0,n.iq)("products",{id:(0,i.e$)("id").primaryKey().autoincrement(),imageUrl:(0,o.fL)("image_url").notNull(),name:(0,o.fL)("name").notNull(),status:(0,u.MI)("status",["active","inactive","archived"]).notNull(),price:(0,c.gH)("price",{precision:10,scale:2}).notNull(),stock:(0,i.e$)("stock").notNull(),availableAt:(0,l.AB)("available_at").notNull()}),b=(0,n.iq)("admin",{id_user:(0,i.e$)("id_user").primaryKey().autoincrement(),username:(0,d.L7)("username",{length:20}).notNull(),password:(0,d.L7)("password",{length:15}).notNull()});(0,n.iq)("forum",{idPesan:(0,i.e$)("id_pesan").primaryKey().autoincrement(),isiPesan:(0,o.fL)("isi_pesan").notNull(),gambarSimbarUser:(0,p.Ec)("gambar_simbar_user"),kategori:(0,d.L7)("kategori",{length:255}).notNull()}),(0,n.iq)("testimoni",{idTestimoni:(0,i.e$)("id_testimoni").primaryKey().autoincrement(),nama:(0,o.fL)("nama").notNull(),deskripsi:(0,o.fL)("deskripsi").notNull(),rating:(0,i.e$)("rating").notNull()});let q=(0,n.iq)("transaksi",{id_transaksi:(0,i.e$)("id_transaksi").primaryKey().autoincrement(),id_user:(0,i.e$)("id_user").notNull().references(()=>x.idUser),harga:(0,i.e$)("harga").notNull(),tanggal:(0,m.hT)("tanggal").notNull(),status:(0,u.MI)("status",["completed","pending","canceled"]).notNull().default("pending")}),x=(0,n.iq)("user",{idUser:(0,i.e$)("id_user").primaryKey().autoincrement(),nama:(0,d.L7)("nama",{length:30}).notNull(),no_telp:(0,i.e$)("no_telp").notNull(),alamat:(0,o.fL)("alamat").notNull(),email:(0,o.fL)("email").notNull()});async function k(e,t=0){try{if(e){let r=await N.select().from(v).where((0,f.vL)(v.name,`%${e}%`)).limit(1e3);return{products:r,newOffset:t,totalProducts:r.length}}let r=await N.select({count:(0,g.QX)()}).from(v),s=Number(r[0].count),a=await N.select().from(v).limit(5).offset(t);return a.length,{products:a,newOffset:t,totalProducts:s}}catch(e){return console.error("Error fetching products:",e),{products:[],newOffset:0,totalProducts:0}}}async function P(e){try{let t=await N.select().from(b).where((0,f.eq)(b.username,e)).limit(1);return t.length>0?t[0]:null}catch(e){return console.error("Error fetching admin:",e),null}}async function O(e=0){try{let t=await N.select({count:(0,g.QX)()}).from(x);return{users:await N.select().from(x).limit(10).offset(e),totalUsers:Number(t[0].count)}}catch(e){return console.error("Error fetching users:",e),{users:[],totalUsers:0}}}async function S(e=0){try{let t=await N.select({count:(0,g.QX)()}).from(q);return{transactions:(await N.select({id_transaksi:q.id_transaksi,id_user:q.id_user,harga:q.harga,tanggal:q.tanggal,status:q.status,userName:x.nama}).from(q).leftJoin(x,(0,f.eq)(q.id_user,x.idUser)).limit(10).offset(e).orderBy((0,h.C)(q.tanggal))).map(e=>({...e,userName:e.userName||"Pengguna Tidak Dikenal"})),totalTransactions:Number(t[0].count)}}catch(e){return console.error("Error fetching transactions with user data:",e),{transactions:[],totalTransactions:0}}}async function L(){try{return await N.select().from(v).limit(1),console.log("Database connection successful"),{success:!0}}catch(e){return console.error("Database initialization error:",e),{success:!1,error:e}}}async function U(e,t){try{return await N.update(b).set({password:t}).where((0,f.eq)(b.id_user,e)),!0}catch(e){throw console.error("Error updating admin password:",e),e}}async function M(){try{let e=await N.select({month:(0,y.i6)`DATE_FORMAT(tanggal, '%Y-%m')`,total:(0,y.i6)`COUNT(id_transaksi)`,revenue:(0,y.i6)`SUM(harga)`}).from(q).groupBy((0,y.i6)`DATE_FORMAT(tanggal, '%Y-%m')`).orderBy((0,y.i6)`DATE_FORMAT(tanggal, '%Y-%m')`).limit(12),t=await N.select({status:q.status,count:(0,g.QX)(),revenue:(0,y.i6)`SUM(harga)`}).from(q).groupBy(q.status),r=await N.select({id_user:q.id_user,totalPurchases:(0,g.QX)(),totalSpent:(0,y.i6)`SUM(harga)`}).from(q).where((0,f.eq)(q.status,"completed")).groupBy(q.id_user).orderBy((0,h.C)((0,y.i6)`SUM(harga)`)).limit(5);return{monthlyTransactions:e,transactionsByStatus:t,topCustomers:r}}catch(e){return console.error("Error fetching transaction analytics:",e),{monthlyTransactions:[],transactionsByStatus:[],topCustomers:[]}}}async function R(e){try{if(0===e.length)return[];return await N.select().from(x).where((0,f.d3)(x.idUser,e))}catch(e){return console.error("Error fetching users by IDs:",e),[]}}async function T(e=0,t=10){try{let r=await N.select().from(x).limit(t).offset(e),s=await N.select({count:(0,g.QX)()}).from(x);return{users:r,totalUsers:s[0].count}}catch(e){return console.error("Error fetching users:",e),{users:[],totalUsers:0}}}async function A(e){try{return await N.select().from(q).where((0,f.eq)(q.id_user,e))}catch(t){return console.error(`Error fetching transactions for user ${e}:`,t),[]}}async function E(e){try{let t=await N.select().from(x).where((0,f.eq)(x.idUser,e)).limit(1);return t.length>0?t[0]:null}catch(t){return console.error(`Error fetching user ${e}:`,t),null}}(0,w.fC)(v)},93159:(e,t,r)=>{"use strict";r.d(t,{G:()=>i,c:()=>n});var s=r(67096),a=r.n(s);async function n(e){return await a().hash(e,10)}async function i(e,t){return await a().compare(e,t)}},73278:(e,t,r)=>{"use strict";e.exports=r(30517)},54203:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ReflectAdapter",{enumerable:!0,get:function(){return r}});class r{static get(e,t,r){let s=Reflect.get(e,t,r);return"function"==typeof s?s.bind(e):s}static set(e,t,r,s){return Reflect.set(e,t,r,s)}static has(e,t){return Reflect.has(e,t)}static deleteProperty(e,t){return Reflect.deleteProperty(e,t)}}},24444:(e,t)=>{"use strict";function r(e,t){let r;let s=e.split("/");return(t||[]).some(t=>!!s[1]&&s[1].toLowerCase()===t.toLowerCase()&&(r=t,s.splice(1,1),e=s.join("/")||"/",!0)),{pathname:e,detectedLocale:r}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"normalizeLocalePath",{enumerable:!0,get:function(){return r}})},98050:(e,t)=>{"use strict";function r(e){return e.replace(/\/$/,"")||"/"}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"removeTrailingSlash",{enumerable:!0,get:function(){return r}})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[379,61,309],()=>r(25463));module.exports=s})();